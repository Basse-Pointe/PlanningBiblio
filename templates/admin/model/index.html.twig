{# admin/template/index.html.twig #}

{% extends 'base.html.twig' %}

{% block specificjs %}
  <script type='text/JavaScript'>
    function delete_template(id, statedweek) {
      if (confirm("Etes vous sûr de vouloir supprimer cet élément ?")) {
        url = '/model/' + id;
        if (statedweek == true) {
          url = '/statedweekmodel/' + id;
        }
        $.ajax({
          url: url,
          type: "DEL",
          success: function(data) {
            window.location.reload(false);
          },
          error: function() {
            CJInfo("Une erreur est survenue lors de la suppression","error");
          }
        });
      }
    }
  </script>
{% endblock %}

{% block page %}
    <h3>Modèles</h3>

    {% if templates or statedweek_templates %}

        <div class="tableaux-cfg">
          <h3>Modèles de planning</h3>
          <table id='tableModeles' class='CJDataTable' data-sort='[[1]]'>
              <thead>
                <tr>
                  <th class='dataTableNoSort'>&nbsp;</th>
                  <th>nom</th>
                </tr>
              </thead>
              <tbody>
                {% for t in templates %}
                  <tr>
                    <td>
                      <a href='{{ asset("/model/") }}{{ t.id }}'><span class='pl-icon pl-icon-edit' title='Modifier'></span></a>
                      <a href='javascript:delete_template({{ t.id }});'><span class='pl-icon pl-icon-drop' title='Supprimer'></span></a>
                    </td>

                    <td>{{ t.nom }}</td>
                  </tr>
                {% endfor %}
              </tbody>
          </table>
        </div>

        <div class="tableaux-cfg">
          <h3>Modèles de planning semaines fixes</h3>
          <table id='tableStatedweekTemplate' class='CJDataTable' data-sort='[[1]]'>
              <thead>
                <tr>
                  <th class='dataTableNoSort'>&nbsp;</th>
                  <th>nom</th>
                </tr>
              </thead>
              <tbody>
                {% for t in statedweek_templates %}
                  <tr>
                    <td>
                      <a href='{{ asset("/statedweekmodel/") }}{{ t.id }}'><span class='pl-icon pl-icon-edit' title='Modifier'></span></a>
                      <a href='javascript:delete_template({{ t.id }}, true);'><span class='pl-icon pl-icon-drop' title='Supprimer'></span></a>
                    </td>

                    <td>{{ t.name }}</td>
                  </tr>
                {% endfor %}
              </tbody>
          </table>
        </div>
    {% else %}
    {% endif %}
{% endblock %}
